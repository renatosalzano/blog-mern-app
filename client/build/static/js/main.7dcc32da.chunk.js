(this["webpackJsonpblog-client"]=this["webpackJsonpblog-client"]||[]).push([[0],{71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=n(36),c=n.n(s),o=n(6),u=n.n(o),i=n(10),l=n(9),b=n(7),j=n(3),p=n.n(j),d=n(5),m=n(4),_=function(){return{auth:Object(r.useCallback)(function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r,a,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.type,r=t.filter,a=t.req_obj,s=t.password,c={status:null},e.prev=2,e.t0=n,e.next="LOG_IN"===e.t0?6:"GET_LOGGED"===e.t0?9:"LOG_OUT"===e.t0?12:"SIGN_UP"===e.t0?15:"UPLOAD_PIC"===e.t0?18:"UPDATE_USER"===e.t0?21:"DELETE_ACCOUNT"===e.t0?24:27;break;case 6:return e.next=8,u.a.post("/auth/login",a);case 8:return e.abrupt("return",c=e.sent);case 9:return e.next=11,u.a.get("/auth/user/info");case 11:return e.abrupt("return",c=e.sent);case 12:return e.next=14,u.a.get("/auth/logout");case 14:return e.abrupt("return",c=e.sent);case 15:return e.next=17,u.a.post("/auth/register",a);case 17:return e.abrupt("return",c=e.sent);case 18:return e.next=20,u.a.post("/auth/user/upload",a);case 20:return e.abrupt("return",c=e.sent);case 21:return e.next=23,u.a.patch("/auth/user/".concat(r),a);case 23:return e.abrupt("return",c=e.sent);case 24:return e.next=26,u.a.delete("/auth/user/delete/".concat(s));case 26:return e.abrupt("return",c=e.sent);case 27:return e.abrupt("return",c);case 28:e.next=33;break;case 30:return e.prev=30,e.t1=e.catch(2),e.abrupt("return",c=e.t1.response);case 33:case"end":return e.stop()}}),e,null,[[2,30]])})));return function(t){return e.apply(this,arguments)}}(),[]),action:Object(r.useCallback)(function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r,a,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.type,r=t.filter,a=t.req_obj,s=t.target_id,e.prev=1,e.t0=n,e.next="NEW_POST"===e.t0?5:"UPDATE_POST"===e.t0?8:"DELETE_POST"===e.t0?11:"NEW_COMMENT"===e.t0?14:"UPDATE_COMMENT"===e.t0?17:"DELETE_COMMENT"===e.t0?20:"SET_LIKE"===e.t0?23:26;break;case 5:return e.next=7,u.a.post("/auth/post/new",a);case 7:return e.abrupt("return",c=e.sent);case 8:return e.next=10,u.a.patch("/auth/post/update/".concat(s),a);case 10:return e.abrupt("return",c=e.sent);case 11:return e.next=13,u.a.delete("/auth/post/remove/".concat(s));case 13:return e.abrupt("return",c=e.sent);case 14:return e.next=16,u.a.post("/auth/comment",a);case 16:return e.abrupt("return",c=e.sent);case 17:return e.next=19,u.a.patch("/auth/comment/update/".concat(s),a);case 19:return e.abrupt("return",c=e.sent);case 20:return e.next=22,u.a.delete("/auth/comment/remove/".concat(s));case 22:return e.abrupt("return",c=e.sent);case 23:return e.next=25,u.a.patch("/auth/".concat(r,"/like"),a);case 25:return e.abrupt("return",c=e.sent);case 26:return e.abrupt("return",c);case 27:e.next=33;break;case 29:return e.prev=29,e.t1=e.catch(1),console.error(e.t1),e.abrupt("return",c=e.t1.response);case 33:case"end":return e.stop()}}),e,null,[[1,29]])})));return function(t){return e.apply(this,arguments)}}(),[])}},f=n(1),O=Object(r.createContext)(),x=function(e){var t=e.children,n=Object(r.useState)(void 0),a=Object(m.a)(n,2),s=a[0],c=a[1],o=Object(r.useState)(!1),u=Object(m.a)(o,2),i=u[0],l=u[1],b=Object(r.useState)(!1),j=Object(m.a)(b,2),x=j[0],h=j[1],v=Object(r.useState)(""),g=Object(m.a)(v,2),w=g[0],k=g[1],N=_().auth,C=function(e){switch(e.status){case 200:return!1;case 400:return console.warn("400 "+e.statusText),console.log(e),k(e.data.error_message),!0;case 401:return console.warn("401 "+e.statusText),c(void 0),!0;case 403:return console.warn("409 "+e.statusText),k(e.data.error_message),c(void 0),!0;case 409:return console.warn("404 "+e.statusText),k(e.data.error_message),c(void 0),!0;case 500:return console.warn("500 "+e.statusText),k(e.statusText),!0;default:return console.warn("An unexpected error has occurred"),k("An unexpected error has occurred"),!0}},y=Object(r.useCallback)((function(){return k("")}),[]),S=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N({type:"LOG_IN",req_obj:t});case 2:if(n=e.sent,!C(n)){e.next=5;break}return e.abrupt("return",!1);case 5:return c((function(e){return n.data.user_info})),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=Object(r.useCallback)(Object(d.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N({type:"GET_LOGGED"});case 2:if(t=e.sent,!C(t)){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",c((function(e){return t.data.user_info})));case 6:case"end":return e.stop()}}),e)}))),[N]),E=function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter,r=t.req_obj,e.next=3,N({type:"UPDATE_USER",filter:n,req_obj:r});case 3:if(a=e.sent,!C(a)){e.next=6;break}return e.abrupt("return",!1);case 6:if("public"===n){e.next=8;break}return e.abrupt("return",!0);case 8:return c((function(e){return a.data.user_info})),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N({type:"SIGN_UP",req_obj:t});case 2:if(n=e.sent,!C(n)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(d.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N({type:"LOG_OUT"});case 2:c(void 0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N({type:"DELETE_ACCOUNT",password:t});case 2:if(n=e.sent,!C(n)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){T()}),[T]),Object(f.jsx)(O.Provider,{value:{user:s,setUser:c,update_account:E,delete_account:A,sign_up:P,log_in:S,log_out:D,newPost:x,setNewPost:h,signUp:i,setSignUp:l,clear_error_message:y,errorMessage:w},children:t})},h=n(11),v=n.p+"static/media/default_user.b6548aa8.png",g=function(e){var t=e.src,n=e.user_name,r=e.is_link;return Object(f.jsx)(f.Fragment,{children:r?Object(f.jsx)(k,{src:t,user_name:n}):Object(f.jsx)(N,{src:t})})},w=Object(r.memo)(g),k=function(e){var t=e.src,n=e.user_name;return Object(f.jsx)(l.b,{to:"/user/".concat(n),className:"user_picture",children:Object(f.jsx)("img",{src:t||v,alt:"user"})})},N=function(e){var t=e.src;return Object(f.jsx)("div",{className:"user_picture",children:Object(f.jsx)("img",{src:t||v,alt:"user"})})},C=n(21),y=function(e){var t=e.user,n=Object(r.useContext)(O).log_out,a=Object(b.g)();return Object(f.jsxs)("div",{className:"user_button",children:[Object(f.jsx)(w,{src:t.pic,is_link:!0,user_name:t.user_name}),Object(f.jsx)(l.b,{to:"/user/".concat(t.user_name),children:t.user_name}),Object(f.jsx)("div",{className:"exit_button",onClick:function(){a.push("/home"),n()},children:Object(f.jsx)(C.c,{})})]})},S=n(38),T=n(17),E=function(e){var t=Object(r.useState)(e),n=Object(m.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)({}),o=Object(m.a)(c,2),u=o[0],l=o[1];return{input:a,setInput:s,input_handler:function(e){e.preventDefault();var t=e.target.name;s((function(n){return Object(i.a)(Object(i.a)({},n),{},Object(T.a)({},t,e.target.value))}))},check_error:function(e){e.required_field;var t=!1,n=function(e){""===a[e].trim()&&(l((function(t){return Object(i.a)(Object(i.a)({},t),{},Object(T.a)({},e,"required"))})),t=!0)};for(var r in a)n(r);return t},clear_error:function(e){var t=e.target.name;l(Object(i.a)(Object(i.a)({},u),{},Object(T.a)({},t,"")))},check_empty_field:function(e){e.preventDefault();var t=e.target.name;if(""===a[t])return l((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(T.a)({},t,"required"))}))},error:u}},P=function(){var e=Object(b.g)(),t=Object(r.useState)(!1),n=Object(m.a)(t,2),a=n[0],s=n[1],c=E({search:""}),o=c.input_handler,u=c.input,i=function(){return s(a?"":"sb_focus")};return Object(f.jsxs)("form",{className:"search_bar_container ".concat(a),onSubmit:function(t){t.preventDefault(),u.search&&e.push("/post/search/title/".concat(u.search))},children:[Object(f.jsx)("input",{type:"text",name:"search",className:"search_bar",onChange:o,value:u.search,onFocus:i,onBlur:i}),Object(f.jsx)("button",{type:"submit",className:"submit_search_button",children:Object(f.jsx)(S.a,{})})]})},D=function(e){var t=e.user;return Object(f.jsxs)("header",{className:"navbar",children:[Object(f.jsx)(l.b,{to:"/home",className:"home_link",children:Object(f.jsx)(h.c,{})}),Object(f.jsx)(P,{}),t?Object(f.jsx)(y,{user:t}):Object(f.jsx)(l.b,{to:"/login",className:"login_link",children:"Log in"})]})},A=n(18),U=function(){return{find:Object(r.useCallback)(function(){var e=Object(d.a)(p.a.mark((function e(t){var n,r,a,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.type,r=t.target,a=t.filter,s=t.value,e.prev=1,e.t0=n,e.next="GET_POST"===e.t0?5:"SRC_POST"===e.t0?9:"FETCH_COMMENT"===e.t0?12:"GET_USER"===e.t0?15:18;break;case 5:return e.next=7,u.a.get("/post/src/");case 7:return c=e.sent,e.abrupt("return",c);case 9:return e.next=11,u.a.get("/post/src/?by=".concat(a,"&value=").concat(s));case 11:return e.abrupt("return",c=e.sent);case 12:return e.next=14,u.a.get("/comment/".concat(r));case 14:return e.abrupt("return",c=e.sent);case 15:return e.next=17,u.a.get("/user/src/".concat(r));case 17:return e.abrupt("return",c=e.sent);case 18:return e.abrupt("return",c);case 19:e.next=25;break;case 21:return e.prev=21,e.t1=e.catch(1),console.error(e.t1),e.abrupt("return",c=e.t1.response);case 25:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}(),[])}},I=function(){var e=_().action,t=U().find,n=Object(r.useState)([]),a=Object(m.a)(n,2),s=a[0],c=a[1],o=Object(r.useState)(null),u=Object(m.a)(o,2),i=u[0],l=u[1],b=Object(r.useState)(""),j=Object(m.a)(b,2),f=j[0],O=j[1],x=Object(r.useState)(!1),h=Object(m.a)(x,2),v=h[0],g=h[1],w=Object(r.useState)(!1),k=Object(m.a)(w,2),N=k[0],C=k[1],y=function(e){switch(e.status){case 200:return!1;case 401:return console.warn("401 "+e.statusText),g(e.statusText),c([]),!0;case 404:return console.warn("404 "+e.statusText),g(e.statusText),c([]),!0;case 500:return console.warn("500 "+e.statusText),g(e.statusText),!0;default:return console.warn("An unexpected error has occurred"),g("An unexpected error has occurred"),!0}},S=Object(r.useCallback)(Object(d.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),g(""),e.next=4,t({type:"GET_POST"});case 4:if(n=e.sent,!y(n)){e.next=7;break}return e.abrupt("return",C(!1));case 7:return C(!1),e.abrupt("return",c(n.data));case 9:case"end":return e.stop()}}),e)}))),[t]),T=Object(r.useCallback)(function(){var e=Object(d.a)(p.a.mark((function e(n,r){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),g(""),e.next=4,t({type:"SRC_POST",filter:n,value:r});case 4:if(a=e.sent,!y(a)){e.next=7;break}return e.abrupt("return",C(!1));case 7:return C(!1),e.abrupt("return",c(a.data));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[t]),E=function(){var t=Object(d.a)(p.a.mark((function t(n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e({type:"NEW_POST",req_obj:n});case 2:if(r=t.sent,!y(r)){t.next=5;break}return t.abrupt("return",!1);case 5:return a=[].concat(Object(A.a)(s),[r.data]),c((function(e){return a})),t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=Object(d.a)(p.a.mark((function t(n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e({type:"DELETE_POST",target_id:n});case 2:if(r=t.sent,!y(r)){t.next=5;break}return t.abrupt("return");case 5:return a=s.filter((function(e){return e.post._id!==n})),t.abrupt("return",c((function(e){return a})));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(){var t=Object(d.a)(p.a.mark((function t(n){var r,a,o,u,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.post_id,a=n.req_obj,t.next=3,e({type:"UPDATE_POST",target_id:r,req_obj:a});case 3:if(o=t.sent,!y(o)){t.next=6;break}return t.abrupt("return",!1);case 6:return u=s.filter((function(e){return e.post._id===r})),i={post:o.data,comment_list:u[0].comment_list,user_info:u[0].user_info},c(s.map((function(e){return e.post._id===r?e=i:e}))),t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=Object(r.useCallback)((function(e){return e.sort((function(e,t){return new Date(e.post.date)-new Date(t.post.date)})),c(e)}),[]);return Object(r.useEffect)((function(){console.log("post sorted..."),I(s)}),[s,I]),{posts:s,postInfo:i,edit:f,get_posts:S,src_posts:T,sumbit_post:E,update_post:D,sort_posts:I,delete_post:P,toggle_edit_post:function(e){if(f)return O(""),l(null);var t=s.filter((function(t){return t.post._id===e}));return l((function(e){return t[0].post})),O((function(t){return e}))},error:v,loadingPost:N}},F=n(39),q=function(){return Object(f.jsx)("div",{className:"spinner_container",children:Object(f.jsx)(F.a,{className:"spinner"})})},M=function(){return Object(f.jsx)("div",{className:"post_loading",children:Object(f.jsx)(q,{})})},L=function(e){var t=e.user,n=e.setNewPost;return Object(f.jsxs)("div",{className:"add_post_button",children:[Object(f.jsx)(w,{src:t.pic}),Object(f.jsx)("span",{onClick:function(){return n((function(e){return!e}))},children:"Scrivi un post..."}),Object(f.jsx)("div",{})]})},R=function(e){var t=Object(r.useState)(""),n=Object(m.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(e),o=Object(m.a)(c,2),u=o[0],i=o[1],l=Object(r.useState)(""),b=Object(m.a)(l,2),j=b[0],p=b[1],d=Object(r.useState)(""),_=Object(m.a)(d,2),f=_[0],O=_[1];return{inputTag:a,tags:u,setInputTag:s,input_tag_handler:function(e){e.preventDefault(),j&&p(""),f&&O(""),s((function(t){return e.target.value}))},check_tags_error:function(){return 0===u.length&&(p("Required"),!0)},submit_tag:function(e){e.preventDefault();var t=a.trim().toLowerCase().replace(/[^A-Z0-9]/gi,"");return j&&p(""),f&&O(""),u.includes(t)?O("Same tag!"):t?(s((function(e){return""})),i((function(e){return[].concat(Object(A.a)(e),[t])}))):s((function(e){return""}))},remove_tag:function(e){if(u.includes(e)){var t=u.filter((function(t){return t!==e}));return i((function(e){return t}))}},tagError:j,ruleWarn:f}},B=function(e){var t=e.class_name,n=e.placeholder,a=e.value,s=e.type,c=e.name,o=e.label,u=e.onChange,i=e.onFocus,l=e.onBlur,b=e.error,j=e.error_message,p=Object(r.useState)(!1),d=Object(m.a)(p,2),_=d[0],O=d[1],x=Object(r.useState)(!1),h=Object(m.a)(x,2),v=h[0],g=h[1],w=Object(r.useRef)(null),k=Object(r.useRef)(null),N=Object(r.useRef)(null),y=function(){return v&&!N.current.value?g(""):g("focus")};Object(r.useLayoutEffect)((function(){var e=N.current===document.activeElement;o&&(w.current.style.marginTop=k.current.scrollHeight+"px",v||e||a||n?k.current.style.setProperty("--x","-100%"):k.current.style.setProperty("--x","0"))}),[o,v,a,k,w,N,n]);return Object(f.jsxs)("div",{className:"".concat(t||"input","_container ").concat(b?"error":""),ref:w,children:[o&&Object(f.jsxs)("label",{htmlFor:c,ref:k,style:{"--x":0},children:[o,b&&Object(f.jsx)(z,{error:b,error_message:j})]}),Object(f.jsx)("input",{className:"".concat(t||"input"," ").concat(v),type:_?"text":s,name:c,onChange:u,onFocus:function(e){i(e),y()},onBlur:function(e){l(e),y()},value:a,placeholder:n,ref:N}),"password"===s&&Object(f.jsx)("span",{className:"view_password",onClick:function(){return O(!_)},children:_?Object(f.jsx)(C.b,{}):Object(f.jsx)(C.a,{})})]})},G=Object(r.memo)(B),z=function(e){var t=e.error,n=e.error_message;return Object(f.jsx)("span",{className:"error_message",children:n||t})},W=function(e){var t=e.onChange,n=e.onSubmit,r=e.onFocus,a=e.onBlur,s=e.tag_arr,c=e.onTagClick,o=e.value,u=e.error,i=e.error_message,l=e.rule_warn,b=e.rule_warn_message;return Object(f.jsxs)("form",{className:"input_tag_form ".concat(u||l?"error":""),onSubmit:n,children:[Object(f.jsxs)("div",{className:"input_tag_container",children:[Object(f.jsx)(V,{tag_arr:s,onTagClick:c}),Object(f.jsx)("input",{className:"input_tag",type:"text",name:"tag",placeholder:"Aggiungi tag...",onChange:t,onFocus:r,onBlur:a,value:o})]}),u&&Object(f.jsx)("span",{className:"error_message",children:i||u}),l&&Object(f.jsx)("span",{className:"rule_message",children:b||l})]})},V=function(e){var t=e.tag_arr,n=e.onTagClick;return t.map((function(e){return Object(f.jsxs)("div",{className:"tag",onClick:function(){return n(e)},children:[e,Object(f.jsx)(h.b,{className:"remove_tag"})]},e)}))},H=n(41),K=function(e){var t=e.onChange,n=e.onFocus,r=e.onBlur,a=e.value,s=e.name,c=e.label,o=e.placeholder,u=e.max_length,i=e.min_rows,l=e.max_rows,b=e.error,j=e.error_message;return Object(f.jsxs)("div",{className:"textarea_container",children:[c&&Object(f.jsx)("label",{htmlFor:s,children:c}),Object(f.jsxs)("div",{className:"textarea_padding",children:[Object(f.jsx)(H.a,{className:"textarea",minRows:i,maxRows:l,name:s,value:a,placeholder:o,onChange:t,onFocus:n,onBlur:r}),b&&Object(f.jsx)("span",{className:"error_message",children:j||b}),u&&Object(f.jsx)("div",{className:"counter",children:Object(f.jsx)("span",{children:u-a.length})})]})]})},J=Object(r.memo)(K),X=function(e){var t=e.user,n=e.sumbit_post,r=e.open,a=e.server_error,s=R([]),c=s.inputTag,o=s.tags,u=s.setInputTag,i=s.input_tag_handler,l=s.check_tags_error,b=s.submit_tag,j=s.remove_tag,m=s.tagError,_=s.ruleWarn,O=E({title:"",content:""}),x=O.input,v=O.setInput,g=O.input_handler,k=O.check_error,N=O.clear_error,C=O.error,y=function(){var e=Object(d.a)(p.a.mark((function e(){var t,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k({required_field:["title","content"]}),s=l(),t||s){e.next=9;break}return c={title:x.title.trim(),content:x.content.trim(),tags:o},e.next=6,n(c);case 6:if(!e.sent){e.next=8;break}return e.abrupt("return",r(!1));case 8:console.warn(a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsx)("div",{className:"new_post_container",children:Object(f.jsxs)("div",{className:"new_post",children:[Object(f.jsxs)("div",{className:"head",children:[Object(f.jsx)(w,{src:t.pic}),Object(f.jsx)("strong",{children:"Crea post"}),Object(f.jsx)("div",{className:"close_button",onClick:function(){u([]),v({title:"",content:""}),r(!1)},children:Object(f.jsx)(h.b,{})})]}),Object(f.jsxs)("div",{className:"scroll_container",children:[Object(f.jsxs)("div",{className:"form_ctrl",children:[Object(f.jsx)(G,{name:"title",label:"Titolo:",value:x.title,onChange:g,onFocus:N,onBlur:N,error:C.title,error_message:"Richiesto"}),Object(f.jsx)(J,{name:"content",placeholder:"Scrivi post...",value:x.content,onChange:g,onFocus:N,error:C.content,error_message:"Il post \xe8 vuoto...",min_rows:10,max_rows:50}),Object(f.jsx)(W,{name:"tag",tag_arr:o,onChange:i,onSubmit:b,onTagClick:j,value:c,error:m,error_message:"Mi serve almeno un Tag",rule_warn:_,rule_warn_message:"Tag gi\xe0 inserito"})]}),a&&Object(f.jsx)("span",{className:"err_message",children:"Si \xe8 verificato un errore imprevisto"})]}),Object(f.jsx)("button",{className:"submit_post_button",onClick:y,children:"Pubblica"})]})})},Z=Object(r.memo)(X),Q=function(e){var t=Object(r.useState)(!1),n=Object(m.a)(t,2),a=n[0],s=n[1];return Object(r.useEffect)((function(){return e.id===e.target_id?s(!0):s(!1)}),[e]),[a]},Y=function(e){var t=e.user,n=e.post_id,r=e.submit_comment,a=E({content:"",post_id:n}),s=a.input,c=a.setInput,o=a.input_handler;return Object(f.jsxs)("div",{className:"add_comment",children:[Object(f.jsx)(w,{src:t.pic}),Object(f.jsxs)("form",{className:"form_ctrl",onSubmit:function(e){e.preventDefault(),r(s),c({content:"",post_id:n})},children:[Object(f.jsx)(J,{name:"content",placeholder:"Scrivi un commento...",value:s.content,onChange:o,min_rows:1,max_rows:50}),s.content&&Object(f.jsx)("button",{className:"submit_comment_button",type:"submit",children:"INVIA"})]})]})},$=Object(r.memo)(Y),ee=n(40),te=function(e){var t=e.target_name,n=e.target_id,a=e.option_delete,s=e.option_edit,c=Object(r.useState)(""),o=Object(m.a)(c,2),u=o[0],i=o[1],l=Object(r.useState)(!1),b=Object(m.a)(l,2),j=b[0],p=b[1];return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"option_button ".concat(u),children:[Object(f.jsx)(ee.a,{onClick:function(){return i(u?"":"open")}}),u&&Object(f.jsx)("div",{className:"option_list",children:j?Object(f.jsxs)("div",{className:"confirm_delete",children:[Object(f.jsx)("span",{children:"Conferma elimina"}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"cancel",onClick:function(){return p(!1)},children:"Annulla"}),Object(f.jsx)("span",{className:"confirm",onClick:function(){return a(n)},children:"OK"})]})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("span",{className:"option",onClick:function(){s(n),i("")},children:"Modifica ".concat(t)}),Object(f.jsx)("span",{className:"option",onClick:function(){return p(!0)},children:"Elimina ".concat(t)})]})}),u&&Object(f.jsx)("div",{className:"trigger",onClick:function(){i(""),p(!1)}})]})})},ne=function(e){var t=e.comment_id,n=e.update_comment,r=e.content,a=e.option_edit,s=E({content:r}),c=s.input,o=s.input_handler,u=function(){var e=Object(d.a)(p.a.mark((function e(r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,n({req_obj:c,comment_id:t});case 3:if(!e.sent){e.next=5;break}return e.abrupt("return",a());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("form",{className:"form_ctrl",onSubmit:u,children:[Object(f.jsx)(J,{name:"content",placeholder:"Scrivi un commento...",value:c.content,onChange:o}),c.content&&Object(f.jsxs)("div",{className:"button_container",children:[Object(f.jsx)("button",{className:"cancel_button",onClick:a,children:"ANNULLA"}),Object(f.jsx)("button",{className:"update_button",type:"submit",children:"INVIA"})]})]})},re=Object(r.memo)(ne),ae=function(e){var t=_().action,n=Object(r.useState)(e.likes),a=Object(m.a)(n,2),s=a[0],c=a[1],o=Object(r.useState)(e.dislikes),u=Object(m.a)(o,2),i=u[0],l=u[1];return{like:s,dislike:i,set_like:Object(r.useCallback)(function(){var e=Object(d.a)(p.a.mark((function e(n){var r,a,s,o,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.target_id,a=n.target_type,s=n.type,console.log("set like fired"),o={target_id:r,type:s},e.next=5,t({type:"SET_LIKE",filter:a,req_obj:o});case 5:if(200===(u=e.sent).status){e.next=8;break}return e.abrupt("return",console.log("unauthorized"));case 8:if("post"!==a){e.next=11;break}return l(u.data.dislike),e.abrupt("return",c(u.data.like));case 11:return e.abrupt("return",c(u.data.like));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t])}},se=function(e){var t=e.like_arr,n=e.onClick,a=Object(r.useContext)(O).user,s=Object(r.useState)(""),c=Object(m.a)(s,2),o=c[0],u=c[1];return Object(r.useEffect)((function(){a&&(t.includes(a.id)?u("liked"):u(""))}),[t,a]),Object(f.jsx)("div",{className:"like_button ".concat(o),onClick:n,children:Object(f.jsxs)("span",{className:"like_count",children:[Object(f.jsx)(h.f,{}),Object(f.jsx)("span",{children:t.length})]})})},ce=Object(r.memo)(se),oe=function(e){var t=e.comment,n=ae({likes:t.like}),r=n.like,a=n.set_like;return Object(f.jsx)("div",{className:"like_container",children:Object(f.jsx)(ce,{like_arr:r,onClick:function(){return a({target_id:t._id,type:"like",target_type:"comment"})}})})},ue=function(e){var t=e.text,n=Object(r.useRef)(),a=Object(r.useState)(!1),s=Object(m.a)(a,2),c=s[0],o=s[1],u=Object(r.useState)(!1),i=Object(m.a)(u,2),l=i[0],b=i[1],j=t.split(/\n/);return Object(r.useEffect)((function(){var e=t;return j.length>5&&!c?((e=j.slice(0,5).join("\n")).length>250&&(e=e.slice(0,250)),b((function(e){return!0})),n.current.textContent=e+"..."):e.length>250?(e=e.slice(0,250),b((function(e){return!0})),n.current.textContent=e+"..."):n.current.textContent=e}),[t,j,c]),Object(f.jsxs)("span",{children:[Object(f.jsx)("p",{className:"text_content",ref:n}),l&&Object(f.jsx)("span",{className:"content_link",onClick:function(){o(!0),b(!1)},children:"Continua"})]})},ie=function(e){var t,n=e.comment,r=e.author,a=e.user,s=e.update_comment,c=e.option_delete,o=e.option_edit,u=e.edit_mode,i=Q({id:a?a.id:"",target_id:n.user_id}),l=Object(m.a)(i,1)[0];return Object(f.jsxs)("div",{className:"comment_container",children:[Object(f.jsx)(w,{src:r.thumbnail,user_name:r.user_name,is_link:!0}),Object(f.jsxs)("div",{className:"comment_content",children:[Object(f.jsxs)("div",{className:"comment_head",children:[Object(f.jsx)("strong",{children:r.user_name}),Object(f.jsx)("span",{className:"date",children:(t=n.date,new Date(t).toLocaleDateString("it-IT",{year:"numeric",month:"long",day:"numeric"}))}),l&&Object(f.jsx)(te,{target_name:"commento",target_id:n._id,option_delete:c,option_edit:o})]}),n._id===u?Object(f.jsx)(re,{comment_id:n._id,content:n.content,update_comment:s,option_edit:o}):Object(f.jsx)(ue,{text:n.content}),n._id===u||Object(f.jsx)(oe,{comment:n})]})]})},le=Object(r.memo)(ie),be=function(e){var t=e.expand_event,n=e.comment_count,r=e.post_id,a=e.loading;return Object(f.jsxs)("div",{onClick:function(){return t(r)},className:"expand_comment",children:[a&&Object(f.jsx)(q,{}),n<2?Object(f.jsx)("span",{children:"Visualizza altri commenti "}):Object(f.jsx)("span",{children:"Visualizza altri ".concat(n," commenti")})]})},je=function(e){var t=e.user,n=e.comment_list,a=e.comment_remain,s=e.post_id,c=function(e){var t=_().action,n=U().find,a=Object(r.useState)(e),s=Object(m.a)(a,2),c=s[0],o=s[1],u=Object(r.useState)(!1),i=Object(m.a)(u,2),l=i[0],b=i[1],j=Object(r.useState)(""),f=Object(m.a)(j,2),O=f[0],x=f[1],h=Object(r.useState)(!1),v=Object(m.a)(h,2),g=v[0],w=v[1],k=Object(r.useState)(!1),N=Object(m.a)(k,2),C=N[0],y=N[1],S=function(e){switch(e.status){case 200:return!1;case 401:return console.warn("401 "+e.statusText),w(e.statusText),o([]),!0;case 404:return console.warn("404 "+e.statusText),w(e.statusText),o([]),!0;case 500:return console.warn("500 "+e.statusText),w(e.statusText),!0;default:return console.warn("An unexpected error has occurred"),w("An unexpected error has occurred"),!0}},T=function(){var e=Object(d.a)(p.a.mark((function e(n){var r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({type:"NEW_COMMENT",req_obj:n});case 2:if(r=e.sent,!S(r)){e.next=5;break}return e.abrupt("return");case 5:return a=[].concat(Object(A.a)(c),[r.data]),e.abrupt("return",D(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(d.a)(p.a.mark((function e(n){var r,a,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.req_obj,a=n.comment_id,e.next=3,t({type:"UPDATE_COMMENT",req_obj:r,target_id:a});case 3:if(s=e.sent,!S(s)){e.next=6;break}return e.abrupt("return",!1);case 6:return o=c.map((function(e){return e.comment._id===a?e=s.data:e})),D(o),e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(p.a.mark((function e(n){var r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({type:"DELETE_COMMENT",target_id:n});case 2:if(r=e.sent,!S(r)){e.next=5;break}return e.abrupt("return");case 5:return a=c.filter((function(e){return e.comment._id!==n})),e.abrupt("return",D(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=Object(r.useCallback)((function(e){return e.sort((function(e,t){return new Date(e.comment.date)-new Date(t.comment.date)})),o(e)}),[]),I=function(){var e=Object(d.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,n({type:"FETCH_COMMENT",target:t});case 3:if(r=e.sent,!S(r)){e.next=6;break}return e.abrupt("return",b(!1));case 6:return b(!1),D(r.data),e.abrupt("return",y((function(e){return!e})));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){console.log("comment_sorted"),D(e)}),[D,e]),{comments:c,expand:C,edit:O,error:g,submit_comment:T,update_comment:E,delete_comment:P,toggle_edit_mode:function(e){return x(O?function(e){return""}:function(t){return e})},fetch_all_comment:I,loadingComment:l}}(n),o=c.comments,u=c.edit,i=c.expand,b=c.submit_comment,j=c.update_comment,O=c.delete_comment,x=c.toggle_edit_mode,h=c.fetch_all_comment,v=c.loadingComment;return Object(f.jsxs)("div",{className:"comment_list",children:[o.map((function(e){return Object(f.jsx)(le,{comment:e.comment,user:t,author:e.author_info,update_comment:j,option_delete:O,option_edit:x,edit_mode:u},e.comment._id)})),a>0&&!i&&Object(f.jsx)(be,{expand_event:h,comment_count:a,post_id:s,loading:v}),t?Object(f.jsx)($,{user:t,post_id:s,submit_comment:b}):Object(f.jsx)(l.b,{to:"/login",className:"text_right",children:"Effettua il login per commentare"})]})},pe=Object(r.memo)(je),de=function(e){var t=e.dislike_arr,n=e.onClick,a=Object(r.useContext)(O).user,s=Object(r.useState)(""),c=Object(m.a)(s,2),o=c[0],u=c[1];return Object(r.useEffect)((function(){a&&(t.includes(a.id)?u("disliked"):u(""))}),[t,a]),Object(f.jsx)("div",{className:"dislike_button ".concat(o),onClick:n,children:Object(f.jsxs)("span",{className:"like_count",children:[Object(f.jsx)(h.e,{}),t.length]})})},me=function(e){var t=e.post,n=ae({likes:t.like,dislikes:t.dislike}),r=n.like,a=n.dislike,s=n.set_like;return Object(f.jsxs)("div",{className:"like_container",children:[Object(f.jsx)(ce,{like_arr:r,onClick:function(){return s({target_id:t._id,type:"like",target_type:"post"})}}),Object(f.jsx)(de,{dislike_arr:a,onClick:function(){return s({target_id:t._id,type:"dislike",target_type:"post"})}})]})},_e=function(e){var t=e.tag_arr;return Object(f.jsx)("div",{className:"tag_container",children:t.map((function(e){return Object(f.jsx)(l.b,{to:"/post/search/tags/".concat(e),className:"tag",children:e},e)}))})},fe=function(e){var t=e.text,n=e.post_id,a=e.no_content_slice,s=e.is_link,c=Object(r.useRef)(),o=Object(r.useState)(!1),u=Object(m.a)(o,2),i=u[0],b=u[1],j=Object(r.useState)(!1),p=Object(m.a)(j,2),d=p[0],_=p[1],O=t.split(/\n/);return Object(r.useEffect)((function(){var e=t;return a?c.current.textContent=e:O.length>5&&!i?((e=O.slice(0,5).join("\n")).length>500&&(e=e.slice(0,500)),_((function(e){return!0})),c.current.textContent=e+"..."):e.length>500&&!i?(e=e.slice(0,500),_((function(e){return!0})),c.current.textContent=e+"..."):c.current.textContent=e}),[t,O,a,i]),Object(f.jsxs)("span",{children:[Object(f.jsx)("p",{className:"text_content",ref:c}),s?d&&Object(f.jsx)(l.b,{className:"content_link",to:"/post/".concat(n),children:"Continua"}):d&&Object(f.jsx)("span",{className:"content_link",onClick:function(){b(!0),_(!1)},children:"Continua"})]})},Oe=function(e){var t,n=e.user,r=e.post,a=e.author,s=e.comment_list,c=e.comment_remain,o=e.option_edit,u=e.option_delete,i=e.no_content_slice,l=e.content_link,b=Q({id:n?n.id:"",target_id:r.user_id}),j=Object(m.a)(b,1)[0];return Object(f.jsxs)("div",{className:"post_container",children:[Object(f.jsxs)("div",{className:"post",children:[Object(f.jsxs)("div",{className:"post_head",children:[Object(f.jsx)(w,{src:a.thumbnail,user_name:a.user_name,is_link:!0}),Object(f.jsxs)("div",{children:[Object(f.jsx)("strong",{children:a.user_name}),Object(f.jsx)("span",{className:"date",children:(t=r.date,new Date(t).toLocaleDateString("it-IT",{year:"numeric",month:"long",day:"numeric"}))})]}),j&&Object(f.jsx)(te,{target_name:"post",target_id:r._id,option_delete:u,option_edit:o})]}),Object(f.jsxs)("article",{className:"post_content",children:[Object(f.jsx)("h2",{children:r.title}),Object(f.jsx)(fe,{text:r.content,post_id:r._id,no_content_slice:i,is_link:l})]}),Object(f.jsx)(_e,{tag_arr:r.tags}),Object(f.jsx)(me,{post:r})]}),Object(f.jsx)(pe,{post_id:r._id,comment_list:s,comment_remain:c,user:n},r._id)]})},xe=Object(r.memo)(Oe),he=function(e){var t=e.user,n=e.update_post,r=e.post,a=e.toggle_edit_post,s=e.server_error,c=R(r.tags?r.tags:[]),o=c.inputTag,u=c.tags,i=c.input_tag_handler,l=c.check_tags_error,b=c.submit_tag,j=c.remove_tag,m=c.tagError,_=c.ruleWarn,O=E({title:r.title,content:r.content}),x=O.input,v=O.input_handler,g=O.check_error,k=O.clear_error,N=O.error,C=function(){var e=Object(d.a)(p.a.mark((function e(){var t,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g({required_field:["title","content"]}),c=l(),t||c){e.next=9;break}return o={title:x.title.trim(),content:x.content.trim(),tags:u},e.next=6,n({req_obj:o,post_id:r._id});case 6:if(!e.sent){e.next=8;break}return e.abrupt("return",a());case 8:return e.abrupt("return",console.warn(s));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsx)("div",{className:"new_post_container",children:Object(f.jsxs)("div",{className:"new_post",children:[Object(f.jsxs)("div",{className:"head",children:[Object(f.jsx)(w,{src:t.pic}),Object(f.jsx)("strong",{children:"Modifica post"}),Object(f.jsx)("div",{className:"close_button",onClick:a,children:Object(f.jsx)(h.b,{})})]}),Object(f.jsxs)("div",{className:"scroll_container",children:[Object(f.jsxs)("div",{className:"form_ctrl",children:[Object(f.jsx)(G,{name:"title",label:"Titolo:",value:x.title,onChange:v,onFocus:k,onBlur:k,error:N.title,error_message:"Richiesto"}),Object(f.jsx)(J,{name:"content",placeholder:"Scrivi post...",font_size:16,value:x.content,onChange:v,onFocus:k,error:N.content,error_message:"Il post \xe8 vuoto...",min_rows:10,max_rows:50}),Object(f.jsx)(W,{name:"tag",tag_arr:u,onChange:i,onSubmit:b,onTagClick:j,value:o,error:m,error_message:"Mi serve almeno un Tag",rule_warn:_,rule_warn_message:"Tag gi\xe0 inserito"})]}),s&&Object(f.jsx)("span",{className:"err_message",children:"Si \xe8 verificato un errore imprevisto"})]}),Object(f.jsx)("button",{className:"submit_post_button",onClick:C,children:"Aggiorna Modifiche"})]})})},ve=Object(r.memo)(he),ge=function(e){var t=e.post_list,n=e.post_info,a=e.sumbit_post,s=e.update_post,c=e.toggle_edit_post,o=e.delete_post,u=e.matched,i=e.edit,l=e.server_error,b=e.no_content_slice,j=e.new_post_button,p=e.content_link,d=Object(r.useContext)(O),m=d.user,_=d.newPost,x=d.setNewPost;return Object(f.jsxs)(f.Fragment,{children:[_&&Object(f.jsx)(Z,{user:m,sumbit_post:a,open:x,server_error:l}),i&&Object(f.jsx)(ve,{user:m,post:n,update_post:s,server_error:l,toggle_edit_post:c}),Object(f.jsxs)("main",{className:"post_list",children:[m&&u&&j&&Object(f.jsx)(L,{user:m,setNewPost:x}),t.length>0?t.map((function(e){return Object(f.jsx)(xe,{post:e.post,author:e.user_info,comment_list:e.comment_list,comment_remain:e.comment_remain,option_delete:o,option_edit:c,user:m,no_content_slice:b,content_link:p},e.post._id)})):Object(f.jsx)("span",{className:"no_post",children:"Ancora nessun post..."})]})]})},we=function(e){var t=e.user,n=I(),a=n.posts,s=n.postInfo,c=n.edit,o=n.get_posts,u=n.sumbit_post,i=n.delete_post,l=n.update_post,b=n.toggle_edit_post,j=n.error,p=n.loadingPost;return Object(r.useEffect)((function(){console.log("getting post..."),o()}),[o]),Object(f.jsx)("div",{className:"page",children:p?Object(f.jsx)(M,{}):Object(f.jsx)(ge,{post_list:a,post_info:s,sumbit_post:u,update_post:l,delete_post:i,user:t,matched:!0,toggle_edit_post:b,edit:c,server_error:j,new_post_button:!0,content_link:!0})})},ke={email:"",password:""},Ne=function(e){var t=e.setSignUp,n=Object(b.g)(),a=Object(r.useRef)(!1),s=Object(r.useContext)(O),c=s.user,o=s.log_in,u=s.errorMessage,i=E(ke),l=i.input,j=i.setInput,m=i.input_handler,_=i.check_error,x=i.clear_error,h=i.check_empty_field,v=i.error,g=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!_({required_field:["email","password"]})){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,o(l);case 5:if(!e.sent){e.next=8;break}return a.current=!0,e.abrupt("return",j(ke));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){c&&a.current&&n.push("/user/".concat(c.user_name))}),[c,n]),Object(f.jsxs)("div",{className:"form_container",children:[Object(f.jsx)("div",{className:"head",children:Object(f.jsx)("strong",{className:"title",children:"Accedi"})}),Object(f.jsxs)("form",{className:"form_ctrl",onSubmit:g,children:[Object(f.jsx)(G,{type:"email",name:"email",label:"Email:",value:l.email,onChange:m,onFocus:x,onBlur:h,error:v.email}),Object(f.jsx)(G,{type:"password",name:"password",label:"Password:",value:l.password,onChange:m,onFocus:x,onBlur:h,error:v.password}),Object(f.jsx)("button",{type:"submit",className:"submit_button",children:"Log in"})]}),u&&Object(f.jsx)("span",{className:"err_message",children:u}),Object(f.jsx)("div",{className:"foot",children:Object(f.jsxs)("span",{className:"question",children:["Non hai un account?",Object(f.jsx)("span",{className:"link",onClick:function(){return t((function(e){return!e}))},children:"Registrati"})]})})]})},Ce={user_name:"",email:"",password:""},ye=function(e){var t=e.setSignUp,n=Object(r.useContext)(O),a=n.sign_up,s=n.errorMessage,c=E(Ce),o=c.input,u=c.setInput,i=c.input_handler,l=c.check_error,b=c.clear_error,j=c.check_empty_field,m=c.error,_=function(){var e=Object(d.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!l({required_field:["email","password"]})){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,a(o);case 5:if(!e.sent){e.next=8;break}return u(Ce),e.abrupt("return",t((function(e){return!e})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:"form_container",children:[Object(f.jsxs)("div",{className:"head",children:[Object(f.jsx)("strong",{className:"title",children:"Registrati"}),Object(f.jsx)("span",{className:"back_button link",onClick:function(){return t((function(e){return!e}))},children:Object(f.jsx)(h.a,{})})]}),Object(f.jsxs)("form",{className:"form_ctrl",onSubmit:_,children:[Object(f.jsx)(G,{type:"text",name:"user_name",label:"Nome Utente:",onChange:i,onFocus:b,onBlur:j,error:m.user_name}),Object(f.jsx)(G,{type:"email",name:"email",label:"Email:",onChange:i,onFocus:b,onBlur:j,error:m.email}),Object(f.jsx)(G,{type:"password",name:"password",label:"Password:",onChange:i,onFocus:b,onBlur:j,value:o.password,error:m.password}),Object(f.jsx)("button",{className:"submit_button",type:"submit",children:"Registrati"})]}),s&&Object(f.jsx)("span",{className:"err_message",children:s})]})},Se=function(){var e=Object(r.useContext)(O),t=e.signUp,n=e.setSignUp,a=e.clear_error_message;return Object(r.useEffect)((function(){a()}),[t,a]),Object(f.jsx)("div",{className:"page",children:Object(f.jsx)("div",{className:"login_section",children:t?Object(f.jsx)(ye,{setSignUp:n}):Object(f.jsx)(Ne,{setSignUp:n})})})},Te=function(){return Object(f.jsxs)("div",{className:"post_404",children:[Object(f.jsx)("span",{children:"Oops!"}),Object(f.jsx)("strong",{children:"404"})]})},Ee=function(e){var t=e.match,n=e.user,a=t.params.type,s=t.params.src,c=I(),o=c.posts,u=c.postInfo,i=c.edit,l=c.src_posts,b=c.sumbit_post,j=c.delete_post,p=c.update_post,d=c.toggle_edit_post,m=c.error,_=c.loadingPost;return Object(r.useEffect)((function(){l(a,s)}),[l,a,s]),Object(f.jsx)("div",{className:"page",children:_?Object(f.jsx)(M,{}):m?Object(f.jsx)(Te,{}):Object(f.jsx)(ge,{post_list:o,post_info:u,sumbit_post:b,update_post:p,delete_post:j,user:n,matched:!0,toggle_edit_post:d,edit:i})})},Pe=function(e){var t=e.user,n=e.match,a=I(),s=a.posts,c=a.postInfo,o=a.edit,u=a.src_posts,i=a.update_post,l=a.toggle_edit_post,b=a.delete_post,j=a.error,p=a.loadingPost;return Object(r.useEffect)((function(){u("_id",n.params.post_id)}),[u,n]),Object(f.jsx)("div",{className:"page",children:p?Object(f.jsx)(M,{}):s.length>0?Object(f.jsx)(ge,{post_list:s,post_info:c,update_post:i,delete_post:b,user:t,matched:!0,toggle_edit_post:l,edit:o,server_error:j,no_content_slice:!0,new_post_button:!1}):!p&&Object(f.jsx)(Te,{})})},De=function(e){var t=e.onClick;return Object(f.jsx)("div",{className:"settings_button",onClick:t,children:Object(f.jsx)(h.d,{})})},Ae=function(e){var t=e.user,n=e.matched,r=e.settings_event;return Object(f.jsxs)("div",{className:"user_header",children:[Object(f.jsx)(w,{src:t.pic,user_name:t.user_name}),Object(f.jsxs)("div",{className:"head",children:[Object(f.jsx)("strong",{children:t.user_name}),n&&Object(f.jsx)(De,{onClick:r})]}),Object(f.jsx)("div",{className:"user_info",children:Object(f.jsx)("span",{children:t.bio})}),Object(f.jsx)("div",{className:"head_color"})]})},Ue=function(e){var t=e.onUpload;return Object(f.jsxs)("div",{className:"upload_button",children:[Object(f.jsx)("span",{children:"Modifica"}),Object(f.jsx)("input",{type:"file",onChange:t,name:"upload_img",accept:".png, .jpg",className:"upload_input"})]})},Ie=function(e){var t=e.user_pic,n=e.user_bio,a=e.update_account,s=Object(r.useState)(!1),c=Object(m.a)(s,2),o=c[0],u=c[1],i=function(){var e=_().auth,t=function(){var t=Object(d.a)(p.a.mark((function t(r){var a,s,c,o,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),a=r.target.files[0],t.prev=2,t.next=5,n(a);case 5:return s=t.sent,c={image:s.split(",").pop()},t.next=9,e({type:"UPLOAD_PIC",req_obj:c});case 9:return o=t.sent,u=o.data.pic,t.abrupt("return",u);case 14:return t.prev=14,t.t0=t.catch(2),console.warn(t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[2,14]])})));return function(e){return t.apply(this,arguments)}}(),n=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){t(r.result)},r.onerror=function(e){n(e)}}))};return{upload_pic:t}}().upload_pic,l=E({bio:n,max_length:200}),b=l.input,j=l.input_handler,O=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,i(t);case 3:if(!(n=e.sent)){e.next=8;break}if(!a({req_obj:{pic:n},filter:"public"})){e.next=8;break}return e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n={bio:b.bio},!a({req_obj:n,filter:"public"})){e.next=4;break}return e.abrupt("return");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){return n!==b.bio?u(!0):u(!1)}),[n,b.bio]),Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"section",children:[Object(f.jsxs)("div",{className:"upload_pic_container",children:[Object(f.jsx)(w,{src:t}),Object(f.jsx)(Ue,{onUpload:O})]}),Object(f.jsxs)("form",{className:"form_ctrl",onSubmit:x,children:[Object(f.jsx)(J,{value:b.bio,label:"Bio: ",name:"bio",onChange:j,font_size:18,padding:5,max_length:200,min_rows:3,max_rows:20}),o?Object(f.jsx)("button",{type:"submit",className:"submit_button button",children:"Salva Modifiche"}):Object(f.jsx)("span",{className:"idle_button button",children:"Salva Modifiche"})]})]})})},Fe=Object(r.memo)(Ie),qe=function(e){var t=e.user_name,n=e.email,a=Object(b.g)(),s=Object(r.useContext)(O),c=s.update_account,o=s.log_out,u=E({user_name:"",email:""}),i=u.input,l=u.input_handler,j=function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),i.user_name||i.email){e.next=3;break}return e.abrupt("return");case 3:if(n={user_name:i.user_name,email:i.email},i.email||(n={user_name:i.user_name}),i.user_name||(n={email:i.email}),!c({req_obj:n,filter:"account"})){e.next=9;break}return a.push("/login"),e.abrupt("return",o());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:"section",children:[Object(f.jsx)("span",{className:"message",children:"Dovrai rieffettuare l'accesso"}),Object(f.jsxs)("form",{className:"form_ctrl",onSubmit:j,children:[Object(f.jsx)(G,{value:i.user_name,type:"text",name:"user_name",label:"Nome Utente:",onChange:l,placeholder:t}),Object(f.jsx)(G,{value:i.email,type:"email",name:"email",label:"Email:",onChange:l,placeholder:n}),i.user_name||i.email?Object(f.jsx)("button",{className:"submit_button button",type:"submit",children:"Aggiorna Account"}):Object(f.jsx)("span",{className:"idle_button button",children:"Aggiorna Account"})]})]})},Me={required_field:["password","new_password"]},Le=function(){var e=Object(b.g)(),t=Object(r.useContext)(O),n=t.update_account,a=t.log_out,s=E({password:"",new_password:""}),c=s.input,o=s.input_handler,u=s.clear_error,i=s.check_error,l=s.error,j=function(){var t=Object(d.a)(p.a.mark((function t(r){var s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),!i(Me)){t.next=3;break}return t.abrupt("return");case 3:if(s={password:c.password,new_password:c.new_password},!n({req_obj:s,filter:"password"})){t.next=7;break}return e.push("/login"),t.abrupt("return",a());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:"section",children:[Object(f.jsx)("span",{className:"message",children:"Dovrai rieffettuare l'accesso"}),Object(f.jsxs)("form",{onSubmit:j,className:"form_ctrl",children:[Object(f.jsx)(G,{value:c.password,type:"password",name:"password",label:"Password Corrente:",onChange:o,onFocus:u,error:l.password,error_message:"obbligatoria"}),Object(f.jsx)(G,{value:c.new_password,type:"password",name:"new_password",label:"Nuova Password:",onChange:o,onFocus:u,error:l.new_password,error_message:"obbligatoria"}),c.password||c.new_password?Object(f.jsx)("button",{type:"submit",className:"submit_button button",children:"Aggiorna la tua password"}):Object(f.jsx)("span",{className:"idle_button button",children:"Aggiorna la tua password"})]})]})},Re=function(){var e=Object(r.useState)(!1),t=Object(m.a)(e,2),n=t[0],a=t[1];return Object(f.jsx)("div",{className:"section",children:n?Object(f.jsx)(Be,{cancel_event:function(){return a(!1)}}):Object(f.jsx)(Ge,{cancel_event:function(){return a(!0)}})})},Be=function(e){var t=e.cancel_event,n=Object(b.g)(),a=Object(r.useContext)(O),s=a.delete_account,c=a.log_out,o=E({password:""}),u=o.input,i=o.input_handler,l=o.check_error,j=o.clear_error,m=o.error,_=function(){var e=Object(d.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!l({required_field:["password"]})){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,s(u.password);case 5:if(!e.sent){e.next=8;break}return n.push("/login"),e.abrupt("return",c());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("form",{onSubmit:_,className:"form_ctrl",children:[Object(f.jsxs)("span",{className:"message",children:["Inserisci password per confermare:",m.password&&Object(f.jsx)("span",{className:"error_message",children:"Password obbligatoria"})]}),Object(f.jsx)(G,{value:u.password,type:"password",name:"password",onChange:i,onFocus:j}),Object(f.jsxs)("div",{className:"button_container",children:[Object(f.jsx)("span",{className:"cancel_button button",onClick:t,children:"ANNULLA"}),Object(f.jsx)("button",{className:"delete_button button",type:"submit",children:"CONFERMA"})]})]})})},Ge=function(e){var t=e.cancel_event;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("span",{className:"message",children:"Una volta cancellato, non potrai tornare indietro"}),Object(f.jsx)("span",{className:"submit_button button",onClick:t,children:"Elimina il tuo account"})]})},ze=function(e){var t=e.close_event,n=e.update_account,a=Object(r.useContext)(O).user,s=a.user_name,c=a.email,o=a.bio,u=a.pic;return Object(f.jsx)("div",{className:"user_panel_container",children:Object(f.jsxs)("div",{className:"user_panel",children:[Object(f.jsxs)("div",{className:"head",children:[Object(f.jsx)("strong",{children:"Impostazioni"}),Object(f.jsx)("span",{onClick:t,children:"X"})]}),Object(f.jsxs)("div",{className:"scroll_container",children:[Object(f.jsx)(We,{section_class:"public_section",section_name:"Profilo Pubblico",is_open:!0,component:Object(f.jsx)(Fe,{update_account:n,user_bio:o||"",user_pic:u})}),Object(f.jsx)(We,{section_class:"account_section",section_name:"Account",component:Object(f.jsx)(qe,{user_name:s,email:c})}),Object(f.jsx)(We,{section_class:"password_section",section_name:"Aggiorna Password",component:Object(f.jsx)(Le,{})}),Object(f.jsx)(We,{section_class:"delete_section",section_name:"Elimina Account",component:Object(f.jsx)(Re,{})})]})]})})},We=function(e){var t=e.section_name,n=e.section_class,a=e.component,s=e.is_open,c=Object(r.useState)(s?"open":""),o=Object(m.a)(c,2),u=o[0],i=o[1];return Object(f.jsxs)("div",{className:"section_container ".concat(n),children:[Object(f.jsx)("div",{className:"section_head ".concat(u),onClick:function(){return i(u?"":"open")},children:Object(f.jsx)("strong",{className:"section_name",children:t})}),u&&a]})},Ve=function(e){var t=e.match,n=e.user,a=e.update_account,s=t.params.user_name,c=I(),o=c.posts,u=c.postInfo,i=c.edit,l=c.src_posts,b=c.sumbit_post,j=c.update_post,_=c.toggle_edit_post,O=c.delete_post,x=c.loadingPost,h=function(e){var t=Object(r.useState)({}),n=Object(m.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(""),o=Object(m.a)(c,2),u=o[0],i=o[1],l=U().find,b=Q({id:e.user_name&&e.user_name,target_id:e.params}),j=Object(m.a)(b,1)[0],_=Object(r.useState)(!1),f=Object(m.a)(_,2),O=f[0],x=f[1],h=function(e){switch(e.status){case 200:return!1;case 401:return console.warn("401 "+e.statusText),i(e.statusText),!0;case 404:return console.warn("404 "+e.statusText),i(e.statusText),!0;case 409:return console.warn("409 "+e.statusText),i(e.statusText),!0;case 500:return console.warn("500 "+e.statusText),i(e.statusText),!0;default:return console.warn("An unexpected error has occurred"),i("An unexpected error has occurred"),!0}},v=Object(r.useCallback)(function(){var e=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({type:"GET_USER",target:t});case 2:if(n=e.sent,!h(n)){e.next=5;break}return e.abrupt("return");case 5:s(n.data.user);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[l]);return Object(r.useEffect)((function(){v(e.params)}),[v,e.params]),{userInfo:a,matched:j,editMode:O,toggle_edit_mode:function(){x((function(e){return!e}))},error:u}}({params:t.params.user_name,user_name:n&&n.user_name}),v=h.userInfo,g=h.editMode,w=h.matched,k=h.toggle_edit_mode;return Object(r.useEffect)((function(){l("user_name",s)}),[l,s,n]),Object(f.jsxs)("div",{className:"page",children:[g&&Object(f.jsx)(ze,{update_account:a,close_event:k}),v&&Object(f.jsx)(Ae,{user:w?n:v,matched:w,settings_event:k}),x?Object(f.jsx)(M,{}):Object(f.jsx)(ge,{post_list:o,post_info:u,sumbit_post:b,update_post:j,delete_post:O,user:n,matched:w,toggle_edit_post:_,edit:i,new_post_button:!0})]})},He=function(){var e=Object(r.useContext)(O),t=e.user,n=e.log_out,a=e.update_account;return Object(f.jsxs)(l.a,{children:[Object(f.jsx)(D,{user:t,log_out:n}),Object(f.jsx)("div",{className:"page_container",children:Object(f.jsxs)(b.d,{children:[Object(f.jsx)(b.b,{exact:!0,path:"/",children:Object(f.jsx)(b.a,{to:"/home"})}),Object(f.jsx)(b.b,{path:"/login",component:Se}),Object(f.jsx)(b.b,{path:"/home",render:function(e){return Object(f.jsx)(we,Object(i.a)(Object(i.a)({},e),{},{user:t}))}}),Object(f.jsx)(b.b,{path:"/post/search/:type/:src",render:function(e){return Object(f.jsx)(Ee,Object(i.a)(Object(i.a)({},e),{},{user:t}))}}),Object(f.jsx)(b.b,{path:"/post/:post_id?",render:function(e){return Object(f.jsx)(Pe,Object(i.a)(Object(i.a)({},e),{},{user:t}))}}),Object(f.jsx)(b.b,{path:"/user/:user_name?",render:function(e){return Object(f.jsx)(Ve,Object(i.a)(Object(i.a)({},e),{},{user:t,update_account:a}))}})]})})]})};n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78);u.a.defaults.withCredentials=!0;var Ke=function(){return Object(f.jsx)("div",{className:"layout",children:Object(f.jsx)(x,{children:Object(f.jsx)(He,{})})})};c.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(Ke,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.7dcc32da.chunk.js.map